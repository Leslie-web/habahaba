<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="theme-color" content="#008300FF">
    <title>Document</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='/css/materialize.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='/css/ukulima_transactions.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='/css/jquery.dataTables.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='/css/m_icons.css') }}">
    <link rel="manifest" href="../static/js/manifest.json">

    <script type="text/javascript" src="{{ url_for('static', filename='/js/jquery-3.6.1.min.js') }}"></script>

    <!--IOS support-->
    <link rel="apple-touch-icon" href="../static/images/pngwing.com.png">
    <meta name="apple-web-app-status-bar" content="#00b0ff">

    {#    chart.js#}
</head>
<body>
{#navbar#}
<nav class="nav-wrapper green lighten-2 {#hide-on-med-and-down#} hide-on-med-and-down">
    <a href="#" class="sidenav-trigger" data-target="mobile_links">
        <i class="material-icons">menu</i>
    </a>
    <a href="#" class="brand-logo">Habahaba Ukulima</a>
    <ul class="right hide-on-med-and-down">
        <li><a href="{{ url_for('ukulima') }}">Ukulima Wallet</a></li>
        <li><a href="#">About</a></li>
        <li><a href="#">Services</a></li>
        <li><a href="{{ url_for('user_logout') }}">Logout</a></li>
    </ul>
</nav>
<a href="#" class="sidenav-trigger btn transparent hide-on-med-and-up" data-target="mobile_links">
    <i class="material-icons">menu</i>
</a>
<ul class="sidenav" id="mobile_links">
    <div class="nav_container"
         style="height: 100vw; display: flex; flex-direction: column; justify-content: space-between">
        <ul class="top">
            <li><a href="{{ url_for('ukulima') }}">Ukulima Wallet</a></li>
            <li><a href="#">Services</a></li>
            <li><a href="#">About</a></li>
        </ul>
        <ul class="logout">
            <li><a href="{{ url_for('user_logout') }}">Logout</a></li>
        </ul>
    </div>
</ul>

<a href="{{ url_for('ukulima') }}" class="btn-floating waves-effect waves-light {#blue lighten-3#} hide-on-large-only"
   id="back_button">
    <ion-icon name="arrow-back-outline" class="back_icon"></ion-icon>
</a>

<div class="section1">
    <div class="row">
        <div class="icon_description">
            <h3 style="text-align: center;">Transactions</h3>
        </div>
        <div class="main_icon">
            <ion-icon name="stats-chart-outline" class="target_icon"></ion-icon>
        </div>
        <div class="line" style="width: 20vw;display: flex; margin: 2em auto auto; border: 1px solid white">

        </div>
    </div>

</div>

<div class="row white black-text">
    <div class="col s12">
        <ul class="tabs" id="tabs-swipe-demo">
            <li class="tab col s6"><a href="#section2">Deposits</a></li>
            <li class="tab col s6"><a href="#section3">Redeemed</a></li>

        </ul>
    </div>
    {#    <div id="test1" class="col s12">Test 1</div>#}
    {#    <div id="test2" class="col s12">Test 2</div>#}
    {#    <div id="test3" class="col s12">Test 3</div>#}
    <div class="section2 white black-text col s12" id="section2">
        <div class="section2_heading black-text">
            <center><h4><u>Deposited</u></h4></center>
        </div>

        <div class="deposited_details">

        </div>
    </div>

    <div class="section3 white black-text col s12" id="section3">
        <div class="section3_heading black-text">
            <center><h4><u>Redeemed</u></h4></center>
        </div>

        <div class="redeemed_details">

        </div>

    </div>

    {#    <div id="test4" class="col s12">Test 4</div>#}
</div>
{#<div class="section2 white black-text" id="section2" style="height: auto">#}
{#    <div class="section2_heading black-text">#}
{#        <center><h4><u>Deposited</u></h4></center>#}
{#    </div>#}
{##}
{#    <div class="deposited_details">#}
{##}
{#    </div>#}
{#</div>#}
{##}
{#<div class="section3 white black-text" id="section3">#}
{#    <div class="section3_heading black-text">#}
{#        <center><h4><u>Redeemed</u></h4></center>#}
{#    </div>#}
{##}
{#    <div class="redeemed_details">#}
{##}
{#    </div>#}
{##}
{#</div>#}

{#[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[JAVASCRIPT]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]#}
{#ionicons#}
<script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
<script type="text/javascript" src="{{ url_for('static', filename='/js/materialize.min.js') }}"></script>
{#moment js#}
<script type="text/javascript" src="{{ url_for('static', filename='/js/moment.min.js') }}"></script>
{#link to app.js for service worker#}
<script src="../static/js/app.js"></script>
{#datatales#}
<script type="text/javascript" src="{{ url_for('static', filename='/js/jquery.dataTables.min.js') }}"></script>
<script>
    //stop auto submit on reload
    if (window.history.replaceState) {
        window.history.replaceState(null, null, window.location.href);
    }
    //sidenav
    $(document).ready(function () {
        $('.sidenav').sidenav();

        $('.tabs').tabs({
            swipeable: false
        })

        //datatables
        $('#transactions').DataTable();

        $.ajax({
            url: '/ukulima-deposits-json/',
            type: 'get',
            success: function (data) {
                data = JSON.parse(data)

                let details = ``
                let dates = ``

                data.map(
                    item => {
                        details += `
<style>
@media all and (max-width: 640px) {
    .details_icon{
    font-size: 30px;
    width: 40px;
    height: 40px;
}
}
</style>
<div class="major_details_container" style="
width: 100%;
display: flex;
justify-content: space-between;
border-bottom: 1px solid black;
">
<div class="icon_details_container" style="display: flex; align-items: center">
<div class="details_icon" style="
font-size: 50px;
width: 50px;
height: 50px;
color: greenyellow;
padding: 5px;
display: flex;
align-items: center;
border-radius: 30px;
box-shadow: 0 0 5px -1px greenyellow;

">
    <ion-icon name="arrow-up-outline"></ion-icon>
</div>

    <div class="major_details" style="padding-left: 10px">
        <b>Deposited to:</b> ${item.org_name}
        <br>
        <b>Category:</b> ${item.cat}
        <br>
        <b>Item:</b> ${item.payment_for}
        <br>
        <b>Amount:</b> Ksh ${item.amount_saved_daily}
    </div>
</div>

    <div class="date_stuff" style="
width: 25%;
">
       <b>Date:</b> ${moment(item.date_sent).format("MMMM Do YYYY")}

    </div>
</div>
                        `
                    }
                )
                $('.deposited_details').html(details)
            }
        });

        $.ajax({
            url: '/ukulima-redeemed-json/',
            type: 'get',
            success: function (data) {
                data = JSON.parse(data)

                let details = ``

                data.map(
                    item => {
                        console.log(item)
                        details += `
<div class="major_details_container" style="
width: 100%;
display: flex;
justify-content: space-between;
border-bottom: 1px solid black;
">
<div class="icon_details_container" style="display: flex; align-items: center">
<div class="details_icon" style="
font-size: 50px;
width: 50px;
height: 50px;
color: red;
padding: 5px;
display: flex;
align-items: center;
border-radius: 30px;
box-shadow: 0 0 5px -1px red;

">
    <ion-icon name="arrow-down-outline"></ion-icon>
</div>

    <div class="major_details" style="padding-left: 10px">
        <b>Redeemed From:</b> ${item.vendor_org}
        <br>
        <b>Category:</b> ${item.cat}
        <br>
        <b>Item:</b> ${item.payment_for}
        <br>
        <b>Quantity:</b> ${item.quantity_redeemed} (KGs / L)
    </div>
</div>

    <div class="date_stuff">
       <b>Date:</b> ${moment(item.date_sent).format("MMMM Do YYYY")}

    </div>
</div>
                        `
                    }
                )
                $('.redeemed_details').html(details)
            }
        })
    });
    //Dropdown
    //$(document).ready(function () {
    //    $('select').formSelect()
    // });
    // })

    //collapsible
    document.addEventListener('DOMContentLoaded', function () {
        let elems = document.querySelectorAll('.collapsible');
        let instances = M.Collapsible.init(elems, {
            inDuration: 300
        });
    });
</script>
</body>
</html>