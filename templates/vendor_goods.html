{% extends 'ukulima_partners.html' %}
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Products</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='/css/materialize.min.css') }}">
    {#    <link rel="stylesheet" href="{{ url_for('static', filename='/css/ukulima_partners.css') }}">#}
    <link rel="stylesheet" href="{{ url_for('static', filename='/css/vendor_goods.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='/css/m_icons.css') }}">
    <link rel="manifest" href="../static/js/manifest.json">

    <script type="text/javascript" src="{{ url_for('static', filename='/js/jquery-3.6.1.min.js') }}"></script>

    <!--IOS support-->
    <link rel="apple-touch-icon" href="../static/images/pngwing.com.png">
    <meta name="apple-web-app-status-bar" content="#00b0ff">

    {#    datatables#}
    <link rel="stylesheet" href="{{ url_for('static', filename='/css/jquery.dataTables.min.css') }}">
</head>
<body>
{% block back_button %}
    <a href="{{ url_for('ukulima_partners') }}"
       class="btn-floating waves-effect waves-light {#blue lighten-3#} hide-on-large-only"
       id="back_button" style="background-color: transparent">
        <ion-icon name="arrow-back-outline" class="back_icon"></ion-icon>
    </a>
{% endblock %}
{% block content %}
    {#    <div class="section1 white black-text" style="padding: 2em; margin-top: 2em;">#}
    {#        <h3 class="center-align">{{ vendor_org['vendor_org'] }}</h3>#}
    {#        <table class="display ui celled table" id="example1">#}
    {#            <thead>#}
    {#            <tr>#}
    {#                <th>#</th>#}
    {#                <th>Product</th>#}
    {#                <th>Price per KG/L (in Ksh)</th>#}
    {#                <th>Action</th>#}
    {#            </tr>#}
    {#            </thead>#}
    {##}
    {#            <tbody>#}
    {#            {% for product in vendors %}#}
    {#                <tr>#}
    {#                    <td>{{ loop.index }}</td>#}
    {#                    <td>{{ product['crop_name'] }}</td>#}
    {#                    <td>{{ product['price_per_kg'] }}</td>#}
    {#                    <td>#}
    {#                        <form action="{{ url_for('selected_partner_redirect') }}" method="post">#}
    {#                            <input type="number" name="material_id" id="defaults" value="{{ product['material_id'] }}"#}
    {#                                   readonly hidden>#}
    {#                            <input type="number" name="user_id" id="defaults" value="{{ session['user_id'] }}"#}
    {#                                   readonly hidden>#}
    {#                            <label for="defaults"></label>#}
    {#                            <button type="submit" class="btn btn-block waves-effect" style="">#}
    {#                                <i class="material-icons">send</i>#}
    {#                            </button>#}
    {#                        </form>#}
    {#                    </td>#}
    {#                </tr>#}
    {#            {% endfor %}#}
    {##}
    {#            </tbody>#}
    {#        </table>#}
    {#    </div>#}

    <div class="section2 white black-text" style="padding: 5px; margin-top: 5em;">
        <div class="section2_heading">

        </div>
        <div class="section2_details">

        </div>
        <div class="section2_purchase">

        </div>
    </div>


    {#    <div class="section3 white black-text" style="padding: 5px; margin-top: 5em;">#}
    {#        <div class="section3_heading">#}
    {##}
    {#        </div>#}
    {#        <div class="section3_details">#}
    {##}
    {#        </div>#}
    {#        <div class="section3_purchase">#}
    {##}
    {#        </div>#}
    {#    </div>#}
    {% block itemsDiv %}

    {% endblock %}

    {#        [[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[JAVASCRIPT]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]#}
    {#        ionicons#}
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='/js/materialize.min.js') }}"></script>
    {#        link to app.js for service worker#}
    <script src="../static/js/app.js"></script>
    {#        datatables#}
    <script type="text/javascript" src="{{ url_for('static', filename='/js/jquery.dataTables.min.js') }}"></script>
    <script>
        //stop auto submit on reload
        if (window.history.replaceState) {
            window.history.replaceState(null, null, window.location.href);
        }
        //collapsible
        document.addEventListener('DOMContentLoaded', function () {
            let elems = document.querySelectorAll('.collapsible');
            let instances = M.Collapsible.init(elems, {
                inDuration: 300
            });
        });
        //sidenav
        $(document).ready(function () {
            $('.sidenav').sidenav();


            //Dropdown
            $('select').formSelect()


            //datatables
            $('#example1').dataTable();


            //modal
            $('.modal').modal();


            //ajax
            $.ajax({
                url: '/redirected-item/',
                method: 'get',
                success: function (data) {
                    data = JSON.parse(data)
                    {#console.log(data)#}
                    let item_details = ``
                    let heading = ``
                    let purchase = ``
                    data.map(
                        item => {
                            {#console.log(item)#}
                            heading += `<h4 style="text-align: center; text-decoration: underline">${item.org_name}</h4>`
                            {#console.log(item)#}
                            item_details += `
<table class="highlight striped centered">
    <thead>
        <th>Item Name</th>
        <th>Price (per KG / L in Ksh)</th>
        <th>Quantity needed per acre</th>
    </thead>
    <tbody>
        <tr>
            <td>${item.crop_name}</td>
            <td>${item.price_per_kg}</td>
            <td>${item.quantity_per_acre}</td>
        </tr>
    </tbody>
</table>
                            `

                            purchase += `
<form action="/selected-partner-redirect/" method="post">
    <input type="hidden" name="material_id" value="${item.material_id}">
    <div class="btnContainer" style="display: flex; justify-content: center; padding-top: 10px">
        <button type="submit" class="btn waves-effect waves-light">Purchase Item</button>
    </div>
</form>
                           `
                        }
                    )

                    $('.section2_heading').html(heading)
                    $('.section2_details').html(item_details)
                    $('.section2_purchase').html(purchase)

                }
            });

            // getting offers
            $.ajax({
                url: '/vendor-goods-offers-json/',
                type: 'get',
                success: function (data) {
                    data = JSON.parse(data)
                    {#console.log(data)#}

                    let section3Heading = ``
                    let section3Details = ``
                    let section3Purchase = ``
                    data.map(
                        item => {
                            {#console.log(item)#}

                            section3Heading += `

                            `
                        }
                    )
                }
            });
        });
    </script>
{% endblock %}
</body>
</html>